---
import Layout from "../../components/Layout.astro";
import data from "../../data/morse.json";
import { textToMorse } from "../../utils/morse";

export function getStaticPaths() {
  const map = data.morseMap;
  const letters = Object.keys(map).filter(k => k.length === 1 && /[A-Z0-9]/.test(k));
  return letters.map(ch => ({ params: { ch: ch.toLowerCase() }, props: { ch } }));
}

const { ch } = Astro.props;
const code = data.morseMap[ch];
const title = `${ch} in Morse Code: ${code}`;
const description = `Learn how to write ${ch} in Morse code (${code}). Copy it, hear it, and see examples.`;
---
<Layout title={title} description={description}>
  <h1>{ch} in Morse code</h1>
  <p class="muted">Morse code for <strong>{ch}</strong> is: <span class="k">{code}</span></p>

  <div class="card">
    <h2>Copy & examples</h2>
    <p><button id="copy">Copy <span class="k">{code}</span></button></p>
    <p class="muted">Example word: <span class="k">{ch}A</span> → <span class="k">{textToMorse(`${ch}A`, data.morseMap)}</span></p>
  </div>

  <p class="muted">Next: <a href="/morse-code/a/">alphabet</a> • <a href="/morse-code/numbers/">numbers</a> • <a href="/morse-code/punctuation/">punctuation</a></p>

  <script define:vars={{ code }}>
    const btn = document.getElementById("copy");
    btn.addEventListener("click", async () => {
      try { await navigator.clipboard.writeText(code); btn.textContent="Copied!"; setTimeout(()=>btn.textContent=`Copy ${code}`, 1200); } catch {}
    });
  </script>

  <script type="application/ld+json" set:html={JSON.stringify({
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      { "@type":"Question", "name": `What is ${ch} in Morse code?`, "acceptedAnswer": { "@type":"Answer", "text": `${ch} in Morse code is ${code}.` } }
    ]
  })}></script>
</Layout>
